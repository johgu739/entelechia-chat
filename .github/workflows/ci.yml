name: CI

on:
  push:
    branches: [main]
  pull_request:

jobs:
  validate:
    runs-on: macos-14
    steps:
      - name: Checkout
        uses: actions/checkout@v4

      - name: Install SwiftLint
        run: brew install swiftlint

      - name: ArchitectureGuardian
        run: ./scripts/layering-guard.sh

      - name: SwiftLint (strict)
        run: swiftlint --strict --config .swiftlint.yml

      - name: lint.sh
        run: ./scripts/lint.sh

      - name: Workspace tests
        run: ./scripts/workspace-test.sh
