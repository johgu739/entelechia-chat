// MARK: - Actor-backed ID state

private actor FileIDState {
    private var pathToID: [String: FileID] = [:]
    private var idToPath: [FileID: String] = [:]

    @discardableResult
    func ensureIDs(for path: String) throws -> FileID {
        if let existing = pathToID[path] {
            return existing
        }
        let id = FileID()
        pathToID[path] = id
        idToPath[id] = path
        return id
    }

    func path(for id: FileID) -> String? {
        idToPath[id]
    }
}

